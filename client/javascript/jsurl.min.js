(function(h){h.stringify=function c(b){function f(a){return/[^\w-.]/.test(a)?a.replace(/[^\w-.]/g,function(a){if("$"===a)return"!";a=a.charCodeAt(0);return 256>a?"*"+("00"+a.toString(16)).slice(-2):"**"+("0000"+a.toString(16)).slice(-4)}):a}var a;switch(typeof b){case "number":return isFinite(b)?"~"+b:"~null";case "boolean":return"~"+b;case "string":return"~'"+f(b);case "object":if(!b)return"~null";a=[];if(Array.isArray(b)){for(var e=0;e<b.length;e++)a[e]=c(b[e])||"~null";return"~("+(a.join("")||
"~")+")"}for(e in b)if(b.hasOwnProperty(e)){var l=c(b[e]);l&&a.push(f(e)+l)}return"~("+a.join("~")+")"}};var m={"true":!0,"false":!1,"null":null};h.parse=function(c){function b(b){if(c.charAt(a)!==b)throw Error("bad JSURL syntax: expected "+b+", got "+(c&&c.charAt(a)));a++}function f(){for(var b=a,f,d="";a<e&&"~"!==(f=c.charAt(a))&&")"!==f;)switch(f){case "*":b<a&&(d+=c.substring(b,a));"*"===c.charAt(a+1)?(d+=String.fromCharCode(parseInt(c.substring(a+2,a+6),16)),b=a+=6):(d+=String.fromCharCode(parseInt(c.substring(a+
1,a+3),16)),b=a+=3);break;case "!":b<a&&(d+=c.substring(b,a));d+="$";b=++a;break;default:a++}return d+c.substring(b,a)}if(!c)return c;c=c.replace(/%(25)*27/g,"'");var a=0,e=c.length;return function k(){var d,g;b("~");switch(d=c.charAt(a)){case "(":a++;if("~"===c.charAt(a))if(d=[],")"===c.charAt(a+1))a++;else{do d.push(k());while("~"===c.charAt(a))}else if(d={},")"!==c.charAt(a)){do g=f(),d[g]=k();while("~"===c.charAt(a)&&++a)}b(")");break;case "'":a++;d=f();break;default:for(g=a++;a<e&&/[^)~]/.test(c.charAt(a));)a++;
g=c.substring(g,a);if(/[\d\-]/.test(d))d=parseFloat(g);else if(d=m[g],"undefined"===typeof d)throw Error("bad value keyword: "+g);}return d}()};h.tryParse=function(c,b){try{return h.parse(c)}catch(f){return b}}})("undefined"!==typeof exports?exports:window.JSURL=window.JSURL||{});
