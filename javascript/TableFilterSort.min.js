/*
 jquery.unevent.js 0.2
 https://github.com/yckart/jquery.unevent.js

 Copyright (c) 2013 Yannick Albert (http://yckart.com)
 Licensed under the MIT license (http://www.opensource.org/licenses/mit-license.php).
 2013/07/26
*/
var $jscomp={scope:{},findInternal:function(c,l,g){c instanceof String&&(c=String(c));for(var h=c.length,a=0;a<h;a++){var b=c[a];if(l.call(g,b,a,c))return{i:a,v:b}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(c,l,g){if(g.get||g.set)throw new TypeError("ES3 does not support getters and setters.");c!=Array.prototype&&c!=Object.prototype&&(c[l]=g.value)};
$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(c,l,g,h){if(l){g=$jscomp.global;c=c.split(".");for(h=0;h<c.length-1;h++){var a=c[h];a in g||(g[a]={});g=g[a]}c=c[c.length-1];h=g[c];l=l(h);l!=h&&null!=l&&$jscomp.defineProperty(g,c,{configurable:!0,writable:!0,value:l})}};
$jscomp.polyfill("Array.prototype.find",function(c){return c?c:function(c,g){return $jscomp.findInternal(this,c,g).v}},"es6-impl","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(c){return $jscomp.SYMBOL_PREFIX+(c||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.iterator;c||(c=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[c]&&$jscomp.defineProperty(Array.prototype,c,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(c){var l=0;return $jscomp.iteratorPrototype(function(){return l<c.length?{done:!1,value:c[l++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(c){$jscomp.initSymbolIterator();c={next:c};c[$jscomp.global.Symbol.iterator]=function(){return this};return c};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(c,l){$jscomp.initSymbolIterator();c instanceof String&&(c+="");var g=0,h={next:function(){if(g<c.length){var a=g++;return{value:l(a,c[a]),done:!1}}h.next=function(){return{done:!0,value:void 0}};return h.next()}};h[Symbol.iterator]=function(){return h};return h};
$jscomp.polyfill("Array.prototype.keys",function(c){return c?c:function(){return $jscomp.iteratorFromArray(this,function(c){return c})}},"es6-impl","es3");jQuery(document).ready(function(){if("undefined"!==typeof TableFilterSortTableList){var c;for(c=0;c<TableFilterSortTableList.length;c++)TableFilterSortTableList[c]=jQuery(TableFilterSortTableList[c]).tableFilterSort()}});
(function(c){c.fn.tableFilterSort=function(c){var g=0,h=this,a={debug:!1,baseURL:"",serverConnectionURL:"/tfs/",serverDataToApply:{},filtersParentPageID:"",favouritesParentPageID:"",useBackAndForwardButtons:!0,holderNumber:0,myTableHolder:h,myFilterFormHolder:null,myTable:null,myTableHead:null,myTableBody:null,myRows:null,dataDictionary:[],filterAndSortVariables:["currentFilter","currentFilterOr","currentFilterExcludes","currentSorter"],currentFilter:{},currentFilterOr:[],currentFilterExcludes:{},
currentSorter:{},showFromRow:0,visibleRowCount:50,totalRowCount:0,maximumNumberOfFilterOptions:30,intervalForFilterCheck:1E3,hasFixedTableHeader:!0,hasKeywords:!0,hasFavourites:!1,hasFilterSaving:!1,millisecondsBetweenActions:10,validDataTypes:["number","string","date"],maxNumberOfValuesToCheck:500,favouritesStore:[],startRowFX1:null,startRowFX2:null,endRowFX1:null,endRowFX2:null,filterTitle:"Filter Table",noFilterSelectedText:"No filter selected",closeAndApplyFilterText:"Close and Apply Filter",
currentFilterText:"",greaterThanLabel:"&gt; ",lowerThanLabel:"&lt; ",keywordsCategoryTitle:"Keywords",favouritesCategoryTitle:"Favourites",filtersTitle:"Filter",tableSelector:"table.tableFilterSortTable",rowSelector:"tr.tfsRow",filterItemSelector:"span[data-filter]",showMoreDetailsSelector:".more",moreDetailsSelector:".hidden",filterFormHolderSelector:".tableFilterSortFilterFormHolder",sortLinkSelector:"a.sortable",favouriteLinkSelector:"a.addFav",moreRowEntriesSelector:".tableFilterSortMoreEntries",
matchRowCountSelector:".match-row-number",minRowSelector:".min-row-number",maxRowSelector:".max-row-number",totalRowCountSelector:".total-row-number",visibleRowCountSelector:".total-showing-row-number",paginationSelector:".pagination",saveAndLoadClass:"saveAndLoad",loadingClass:"loading",showClass:"show",hideClass:"hide",matchClass:"match",notMatchClass:"no-match",openedClass:"opened",filterIsOpenClass:"filterIsOpen",sectionFilterClassAppendix:"Filter",commonContentHolderClass:"tableFilterSortCommonContentHolder",
currentSearchFilterClass:"tableFilterSortCurrentSearchHolder",openAndCloseFilterFormClass:"tableFilterSortOpenFilterForm",filterOptionsHolderClass:"tableFilterSortFilterFormOptions",filterGroupClass:"filterColumn",groupLabelClass:"groupLabel",applyFilterClass:"applyFilter",filterInUseClass:"tableFilterSortFilterInUse",filterNotInUseClass:"tableFilterSortFilterNotInUse",noMatchMessageClass:"no-matches-message",sortAscClass:"sort-asc",sortDescClass:"sort-desc",directLinkClass:"dl",favouriteClass:"fav",
init:function(b){a.holderNumber=b;a.myTableHolder=h;a.myFilterFormHolder=a.myTableHolder.find(a.filterFormHolderSelector).first();a.myTable=a.myTableHolder.find(a.tableSelector).first();a.myTableHead=a.myTableHolder.find("table thead");a.myTableBody=a.myTable.find(" > tbody");a.favouritesParentPageID=a.myFilterFormHolder.attr("data-favourites-parent-page-id");"string"===typeof a.favouritesParentPageID&&0<a.favouritesParentPageID.length&&(a.hasFavourites=!0);a.filtersParentPageID=a.myFilterFormHolder.attr("data-filters-parent-page-id");
"string"===typeof a.filtersParentPageID&&0<a.filtersParentPageID.length&&(a.hasFilterSaving=!0);a.baseURL=location.protocol+"//"+location.host+location.pathname;a.resetObjects();1<a.myRows.length&&(a.myTableHolder.addClass(a.loadingClass),window.setTimeout(function(){a.debug&&(console.profileEnd(),console.profile("filterItemCollector"));a.filterItemCollector();a.debug&&(console.profileEnd(),console.profile("tableHideColsWhichAreAllTheSame"));a.tableHideColsWhichAreAllTheSame();a.debug&&(console.profileEnd(),
console.profile("dataDictionaryCollector"));a.dataDictionaryCollector();a.debug&&(console.profileEnd(),console.profile("retrieveLocalCookie"));a.retrieveLocalCookie();a.debug&&(console.profileEnd(),console.profile("retrieveDataFromServer"));a.retrieveDataFromServer();a.debug&&(console.profileEnd(),console.profile("processRetrievedData"));a.processRetrievedData();a.debug&&(console.profileEnd(),console.profile("fixTableHeaderListener"));a.fixTableHeaderListener();a.debug&&(console.profileEnd(),console.profile("setupFilterFormListeners"));
a.setupFilterFormListeners();a.debug&&(console.profileEnd(),console.profile("setupSortListeners"));a.setupSortListeners();a.debug&&(console.profileEnd(),console.profile("paginationListeners"));a.paginationListeners();a.debug&&console.profile("setupMoreDetailsListener");a.setupMoreDetailsListener();a.debug&&console.profile("addURLChangeListener");a.addURLChangeListener();a.debug&&(console.profileEnd(),console.profile("openServerModalWindowListener"));a.openServerModalWindowListener();a.debug&&(console.profileEnd(),
console.profile("favouriteLinkListener"));a.favouriteLinkListener();a.debug&&(console.profileEnd(),console.profile("directFilterLinkListener"));a.directFilterLinkListener();a.debug&&(console.profileEnd(),console.profile("createFilterForm"));a.createFilterForm();a.debug&&(console.profileEnd(),console.profile("workOutCurrentFilter"));a.workOutCurrentFilter();a.debug&&(console.profileEnd(),console.profile("runCurrentSort"));a.runCurrentSort();a.debug&&console.profileEnd();a.myTableHolder.removeClass(a.loadingClass)},
a.millisecondsBetweenActions))},resetObjects:function(){a.myRows=a.myTable.find(a.rowSelector)},filterItemCollector:function(){var b="",d="";a.myRows.each(function(e,c){jQuery(c).find(a.filterItemSelector).each(function(e,c){c=jQuery(c);b=c.text();d=c.attr("data-filter");0<b.trim().length&&(a.debug&&console.debug("adding "+b+" to "+d),"undefined"===typeof a.dataDictionary[d]&&(a.dataDictionary[d]={}),"undefined"===typeof a.dataDictionary[d].Options&&(a.dataDictionary[d].Options=[]),-1===a.dataDictionary[d].Options.indexOf(b)&&
a.dataDictionary[d].Options.push(b))})})},tableHideColsWhichAreAllTheSame:function(){var b=a.myTableHolder.find("."+a.commonContentHolderClass).attr("data-title"),d='<div class="'+a.commonContentHolderClass+'-inner">'+("undefined"!==typeof b?"<h3>"+b+"</h3>":"")+"<ul>",e=!1;Object.keys(a.dataDictionary).forEach(function(b,c){if(1===a.dataDictionary[b].Options.length){delete a.dataDictionary[b];a.debug&&console.debug("tableHideColsWhichAreAllTheSame: checking category: "+b);e=!0;var f=!1;jQuery('span[data-filter="'+
b+'"]').each(function(e,c){c=jQuery(c);f||""===c.html()||c.hasClass("ignore-content")||(d+="<li><strong>"+b+":</strong> <span>"+c.html()+"</span></li>",f=!0);var k=c.parent();c.remove();if(k.is("li"))k.hide();else if(k.is("td")&&0===k.children().length){if(0===e){var m=k.parent("tr").children("td").index(k);a.myTable.find("th").eq(m).remove()}k.remove()}})}});d+="</ul></div>";e?a.myTableHolder.find("."+a.commonContentHolderClass).html(d):a.myTableHolder.find("."+a.commonContentHolderClass).remove()},
dataDictionaryCollector:function(){Object.keys(a.dataDictionary).forEach(function(b,d){"undefined"===typeof a.dataDictionary[b].Options&&(a.dataDictionary[b].Options=[]);var e=a.myTable.find(a.sortLinkSelector+'[data-sort-field="'+b+'"]').first();"undefined"===typeof a.dataDictionary[b].CanFilter&&(e&&"true"==e.attr("data-sort-only")?a.dataDictionary[b].CanFilter=!1:a.dataDictionary[b].CanFilter=1<a.dataDictionary[b].Options.length);"undefined"===typeof a.dataDictionary[b].CanSort&&(a.dataDictionary[b].CanSort=
0<e.length);"undefined"===typeof a.dataDictionary[b].DataType&&a.dataDictionary[b].CanSort&&(e=e.attr("data-sort-type"),a.dataDictionary[b].DataType=e);if("undefined"===typeof a.dataDictionary[b].DataType){for(var e="number",c=!1,f=0,m=a.dataDictionary[b].Options.length<a.maxNumberOfValuesToCheck?a.dataDictionary[b].Options.length:500,f=0;f<m;f++)if(c=jQuery.isNumeric(a.dataDictionary[b].Options[f]),!1===c){e="string";break}a.dataDictionary[b].DataType=e}!1===jQuery.inArray(a.dataDictionary[b].DataType,
a.validDataTypes)&&console.debug("ERROR: invalid DataType for"+b+": "+a.dataDictionary[b].DataType);switch(a.dataDictionary[b].DataType){case "number":a.dataDictionary[b].Options.sort(function(a,b){a=parseFloat(a.replace(/[^0-9.]/g,""));b=parseFloat(b.replace(/[^0-9.]/g,""));return a-b});break;default:a.dataDictionary[b].Options.sort()}})},fixTableHeaderListener:function(){if(a.hasFixedTableHeader)jQuery(window).on("load resize scroll",function(b){a.fixTableHeader()},a.millisecondsBetweenActions)},
setupFilterFormListeners:function(){a.myFilterFormHolder.on("click","."+a.openAndCloseFilterFormClass,function(b){b.preventDefault();a.myFilterFormHolder.find("."+a.filterOptionsHolderClass).toggleClass(a.openedClass).slideToggle("fast");a.myTableHolder.toggleClass(a.filterIsOpenClass);a.myTableHolder.hasClass(a.filterIsOpenClass);return!1});a.myFilterFormHolder.on("change","input",function(b){a.applyFilter()});a.myFilterFormHolder.on("click",".clear a",function(b){b.preventDefault();a.currentFilter=
{};a.createFilterForm();a.applyFilter();return!1})},setupSortListeners:function(){a.myTableHolder.on("click",a.sortLinkSelector,function(b){b.preventDefault();var d=jQuery(this);a.showFromRow=0;a.startRowManipulation();a.myTableHead.find(a.sortLinkSelector).removeClass(a.sortAscClass).removeClass(a.sortDescClass);window.setTimeout(function(){a.currentSorter.category=d.attr("data-sort-field");a.currentSorter.direction=d.attr("data-sort-direction");a.currentSorter.sortType=d.attr("data-sort-type");
"undefined"===typeof a.currentSorter.sortType&&(a.currentSorter.sortType=a.dataDictionary[a.currentSorter.category].DataType);var b=[];a.myRows.each(function(e,d){var c=jQuery(d).find('[data-filter="'+a.currentSorter.category+'"]').text();"number"===a.currentSorter.sortType&&(c=c.replace(/[^\d.-]/g,""),c=parseFloat(c));b.push([c,e])});a.myTableBody.empty();b.sort(a.sortMultiDimensionalArray);var c=a.myTableHead.find(a.sortLinkSelector+'[data-sort-field="'+a.currentSorter.category+'"]');"desc"===a.currentSorter.direction?
(b.reverse(),c.attr("data-sort-direction","asc").addClass(a.sortDescClass)):c.attr("data-sort-direction","desc").addClass(a.sortAscClass);b.forEach(function(b){a.myTableBody.append(a.myRows[b[1]])});a.endRowManipulation()},a.millisecondsBetweenActions)})},paginationListeners:function(){a.myTableHolder.on("click",a.paginationSelector+" a",function(b){b.preventDefault();b=jQuery(this).attr("data-page");a.gotoPage(b);return!1})},setupMoreDetailsListener:function(){a.myTableHolder.on("click",a.showMoreDetailsSelector,
function(b){b.preventDefault();b=jQuery(this);b.closest("tr").toggleClass(a.openedClass).find(a.moreDetailsSelector).each(function(b,e){e=jQuery(e);e.slideToggle();e.toggleClass(a.openedClass)});b.toggleClass(a.openedClass)})},addURLChangeListener:function(){window.addEventListener("popstate",function(b){a.retrieveDataFromServer()})},directFilterLinkListener:function(){a.myTableBody.on("click","span[data-filter]."+a.directLinkClass,function(b){b.preventDefault();var d=jQuery(this);b=d.attr("data-filter");
var e=d.text().trim(),d=a.myFilterFormHolder.find("."+a.filterGroupClass+'[data-to-filter="'+b+'"]'),c=d.attr("field-type"),f=d.find('input[value="'+e+'"].checkbox').first(),m=!0;f&&0<f.length?f.is(":checkbox")&&(!0===f.prop("checked")?(f.prop("checked",!1).trigger("change"),m=!1):f.prop("checked",!0).trigger("change")):"tag"===c&&a.makeCheckboxSection(d.find("input.awesomplete").first(),e);m?a.myRows.find('span.dl[data-filter="'+b+'"]').each(function(b,d){var c=jQuery(d);c.text().trim()===e&&c.addClass(a.directLinkClass+
"-on")}):a.myRows.find('span.dl[data-filter="'+b+'"]').each(function(b,d){var c=jQuery(d);c.text().trim()===e&&c.removeClass(a.directLinkClass+"-on")});a.applyFilter();return!1})},favouriteLinkListener:function(){if(0<a.myTableBody.find(a.favouriteLinkSelector).length)a.myTableHolder.on("click",a.favouriteLinkSelector,function(b){b.preventDefault();var d=jQuery(this).closest("td");b=d.closest("tr");b.toggleClass(a.favouriteClass);var e=b.attr("id");e&&"undefined"!==typeof e&&""!==e&&(b.hasClass(a.favouriteClass)?
(a.favouritesStore.push(e),b='<div id="favouritefader">'+a.makeRetrieveButtons(!0,!1,"favourites")+"</div>",d.append(b).addClass("hasFader"),window.setTimeout(function(){jQuery("#favouritefader").fadeOut(500,function(){jQuery("#favouritefader").remove();d.removeClass("hasFader")})},2E3)):(b=a.favouritesStore.indexOf(e),-1<b&&a.favouritesStore.splice(b,1)),"undefined"!==typeof Cookies&&Cookies.set("favouritesStore",a.favouritesStore,{path:a.baseURL,expires:180}));return!1})},openServerModalWindowListener:function(){a.myTableHolder.on("click",
"."+a.saveAndLoadClass+" a",function(b){b.preventDefault();a.myTable.removeClass(a.loadingClass);var d=jQuery(this);b=d.attr("data-url");var e=d.attr("data-parent-page-id");variables=d.attr("data-variables");variables=variables.split(",");for(var d={},c=0;c<variables.length;c++)d[variables[c]]=a[variables[c]];d.ParentPageID=e;jQuery.post(b,d,function(b){var d=Math.round(.85*jQuery(window).width()),e=Math.round(.85*jQuery(window).height());jQuery.modal('<iframe src="'+b+'" width="'+d+'"height="'+e+
'" style="border:0" id="tfs-pop-up-i-frame" name="tfs-pop-up-i-frame">',{closeHTML:"close",containerCss:{backgroundColor:"#fff",borderColor:"#fff",padding:0,width:d,height:e},opacity:.85,overlayClose:!0,onClose:function(){jQuery.modal.close();a.retrieveDataFromServer()}});return!1}).fail(function(){alert("ERROR!");a.myTable.removeClass(a.loadingClass)});return!1})},createFilterForm:function(){if(0<a.myFilterFormHolder.length){a.myFilterFormHolder.html("");var b="",d=a.myFilterFormHolder.attr("data-title");
"undefined"===typeof d&&(d=a.filterTitle);0===a.myTableHolder.find("."+a.currentSearchFilterClass).length&&(b='<div class="'+a.currentSearchFilterClass+'"></div>');var e=1,c=[],f="<form>"+b+'<a href="#" class="'+a.openAndCloseFilterFormClass+' button closed">'+d+'</a><div style="display: none;" class="'+a.filterOptionsHolderClass+'">';Object.keys(a.dataDictionary).forEach(function(b,d){if(a.dataDictionary[b].CanFilter){e++;var k,m=a.dataDictionary[b].Options.length;if(1<m&&m<=a.maximumNumberOfFilterOptions){f+=
a.makeSectionHeaderForForm("checkbox",b);for(k=0;k<m;k++)f+=a.makeFieldForForm("checkbox",b,e,a.dataDictionary[b].Options[k]);f+=a.makeSectionFooterForForm()}else m>a.maximumNumberOfFilterOptions&&(k=a.dataDictionary[b].DataType,"string"===a.dataDictionary[b].DataType&&(c.push(b),k="tag"),f+=a.makeSectionHeaderForForm(k,b),f+=a.makeFieldForForm(k,b,e,0),f+=a.makeSectionFooterForForm())}});a.hasFavourites&&(f+=a.makeSectionHeaderForForm("favourites",a.favouritesCategoryTitle),f+=a.makeFieldForForm("favourites",
a.favouritesCategoryTitle,e,0),f+=a.makeRetrieveButtons(!0,!0,"favourites"),f+=a.makeSectionFooterForForm(),e++);a.hasKeywords&&(f+=a.makeSectionHeaderForForm("keyword",a.keywordsCategoryTitle),f+=a.makeFieldForForm("keyword",a.keywordsCategoryTitle,e,0),f+=a.makeSectionFooterForForm());b=a.myFilterFormHolder.attr("data-title-close-and-apply");"undefined"===typeof b&&(b=a.closeAndApplyFilterText);f+='<div class="'+a.applyFilterClass+'"><a href="#" class="'+a.openAndCloseFilterFormClass+' button closed">'+
b+"</a></div></div></form>";a.myFilterFormHolder.html(f);for(b=b=0;b<c.length;b++)category=c[b],d=a.myFilterFormHolder.find('input[name="'+category+'"].awesomplete').first(),d=jQuery(d).attr("id"),d=document.getElementById(d),new Awesomplete(d,{list:a.dataDictionary[category].Options,autoFirst:!0,filter:function(a,b){return Awesomplete.FILTER_CONTAINS(a,b)&&-1===Awesomplete.blackList.indexOf(a.value)},replace:function(b){a.makeCheckboxSection(this.input,b.value);this.input.value="";Awesomplete.blackList.push(b.value);
a.applyFilter()}}),Awesomplete.blackList=[]}},makeSectionHeaderForForm:function(b,d){var e=b+a.sectionFilterClassAppendix;d.replace(/\W/g,"");return'<div class="'+a.filterGroupClass+" "+e+'" field-type="'+b+'" data-to-filter="'+d.raw2attr()+'"><label class="'+a.groupLabelClass+'">'+a.replaceAll(d,"-"," ")+"</label><ul>"},makeFieldForForm:function(b,d,e,c){var f=d.replace(/\W/g,""),k=("TFS_"+f+"_"+c.toString()).replace(/[^a-zA-Z0-9]+/g,"_");if(0===a.myFilterFormHolder.find("input#"+k).length){var h=
'<li class="'+b+'Field">';switch(b){case "favourites":var n="";"undefined"!==typeof a.currentFilter[d]&&(n=' checked="checked"');return h+'<input class="favourites" type="checkbox" name="'+d.raw2attr()+'" id="'+k+'" tabindex="'+e+'" '+n+' /><label for="'+k+'">\u2764 \u2764 \u2764</label></li>';case "keyword":case "tag":f=n="";if("keyword"===b){var g="keyword";"undefined"!==typeof a.currentFilter[d]&&"undefined"!==typeof a.currentFilter[d][0]&&(n=a.currentFilter[d].valueToMatch,n=n.raw2attr())}else if("tag"===
b){if("undefined"!==typeof a.currentFilter[d])for(b=0;b<a.currentFilter[d].length;b++)c=a.currentFilter[d].valueToMatch,c=a.makeFieldForForm("checkbox",d,e,c),5<c.length&&(c=c.replace("<input ",'<input checked="checked" ')),f+=c;g="awesomplete"}return h+'<input class="text '+g+'" type="text" name="'+d.raw2attr()+'" id="'+k+'" tabindex="'+e+'" value="'+n+'" />'+f+"</li>";case "checkbox":n="";if("undefined"!==typeof a.currentFilter[d])for(b=0;b<a.currentFilter[d].length;b++)c==a.currentFilter[d].valueToMatch&&
(n='checked="checked"');return h+'<input class="checkbox" type="checkbox" name="'+k+'" id="'+k+'" value="'+c.raw2attr()+'" '+n+' tabindex="'+e+'" /><label for="'+k+'">'+c+"</label></li>";case "number":case "date":return n={gt:"",lt:""},"undefined"!==typeof a.currentFilter[d]&&(n=a.currentFilter[d][0]),d=h+'<span class="gt"> <label for="'+k+'_gt">'+a.greaterThanLabel+'</label> <input data-dir="gt" data-label="'+a.greaterThanLabel.raw2attr()+'" class="number" step="any" type="number" name="'+f+'[]" id="'+
k+'" tabindex="'+e+'" value="'+n.gt.raw2attr()+'" /> </span><span class="lt"> <label for="'+k+'_lt">'+a.lowerThanLabel+'</label> <input data-dir="lt" data-label="'+a.lowerThanLabel.raw2attr()+'"  class="number" step="any" type="number" name="'+f+'[]" id="'+k+'_lt" tabindex="'+e+'" value="'+n.lt.raw2attr()+'" /> </span></li>',"date"===b&&(d=a.replaceAll(d,"number","datetime-local"),d=a.replaceAll(d,"step","86400")),d}}},makeSectionFooterForForm:function(){return"</ul></div>"},makeCheckboxSection:function(b,
d){b=jQuery(b);var e=b.attr("name");tabIndex=b.attr("tabindex");e=a.makeFieldForForm("checkbox",e,tabIndex,d);5<e.length&&(e=e.replace("<input ",'<input checked="checked" '),b.closest("ul").append(e))},runCurrentSort:function(){var b=a.myTableHolder.find("."+a.sortDescClass+", ."+a.sortAscClass).first();b&&0<b.length||(b=a.myTableHolder.find(a.sortLinkSelector+"[data-sort-default=true]").first());b&&0<b.length||(b=a.myTableHolder.find(a.sortLinkSelector).first());b&&0<b.length&&b.click()},applyFilter:function(){a.showFromRow=
0;a.workOutCurrentFilter();a.startRowManipulation();window.setTimeout(function(){a.debug&&(console.debug("=============="),console.debug(a.currentFilter));a.myRows.each(function(b,d){var e=jQuery(d);a.debug&&console.log("===");var c=!0,f=!0;Object.keys(a.currentFilter).forEach(function(b,d){if(f){for(var k=!1,h=!0,g=0;g<a.currentFilter[b].length;g++){var l=a.currentFilter[b][g];if(h){if(b===a.favouritesCategoryTitle){var q=e.attr("id");"undefined"!==typeof q&&0<q.length&&-1<a.favouritesStore.indexOf(q)&&
(k=!0)}else if(b===a.keywordsCategoryTitle){for(var r=l.valueToMatch,q=e.text().toLowerCase(),r=r.split(" "),m=!0,u=0;u<r.length;u++){var x=r[u].trim();if(-1===q.indexOf(x)){m=!1;break}}!0===m&&(k=!0)}else e.find('span[data-filter="'+b+'"]').each(function(d,e){e=jQuery(e);var c=e.text().toLowerCase().trim();switch(a.dataDictionary[b].DataType){case "date":break;case "number":if("undefined"!==typeof l.valueToMatch){var f=l.valueToMatch;c==f&&(k=!0)}else{var c=parseFloat(c.replace(/[^0-9.]/g,"")),h=
l.lt,g=!0;jQuery.isNumeric(h)&&0!==h&&h<c&&(g=!1);g&&(h=l.gt,jQuery.isNumeric(h)&&0!==h&&h>c&&(g=!1));g&&(k=!0);break}default:f=l.valueToMatch,c===f&&(k=!0)}if(k)return a.debug&&console.log("FILTER - MATCH: '"+f+"' in '"+b+"'"),!1;a.debug&&console.log("FILTER - NO MATCH: '"+f+"' in '"+b+"'")});k&&(h=!1)}}k||(f=c=!1)}});c?e.addClass(a.matchClass).removeClass(a.notMatchClass):e.addClass(a.notMatchClass).removeClass(a.matchClass)});a.endRowManipulation();a.debug&&(console.debug(a.currentFilter),console.debug("=============="))},
a.millisecondsBetweenActions)},gotoPage:function(b){a.showFromRow=b*a.visibleRowCount;a.startRowManipulation();a.endRowManipulation()},fixTableHeader:function(){if(a.myTableHolder.isOnScreen()||a.myTableHolder.hasClass(a.filterIsOpenClass)){if(a.myTableHolder.addClass(a.filterInUseClass),a.myTableHolder.removeClass(a.filterNotInUseClass),a.hasFixedTableHeader){var b=a.myFilterFormHolder.outerHeight()+a.myTableHead.outerHeight(),d=a.myTableHolder.find("#tfspushdowndiv");0===d.length?jQuery('<div style="height: '+
b+'px;display: none;" id="tfspushdowndiv"></div>').insertBefore(a.myTable):(d.height(b),d.css("display","none"));b=a.myTableBody.offset().top;b=jQuery(window).scrollTop()>b?!0:!1;a.myTableHolder.removeClass("fixed-header");a.myFilterFormHolder.css("width","");a.myTable.find("thead:first tr th, tbody tr:first td, tbody tr:first th").css({width:"","min-width":""});!0===b&&(b=a.myTableHolder.width(),a.myFilterFormHolder.width(b),window.setTimeout(function(){a.myTableBody.find("tr.show:first th, tr.show:first td").each(function(a,
b){b=jQuery(b);var d=b.width();b.css("min-width",d);jQuery("thead:first tr").each(function(b,e){jQuery(e).children().eq(a).width(d)})});d.css("display","block");a.myTableHolder.addClass("fixed-header")},a.millisecondsBetweenActions),a.myTableHead.css("top",a.myFilterFormHolder.outerHeight()))}}else a.myTableHolder.addClass(a.filterNotInUseClass),a.myTableHolder.removeClass(a.filterInUseClass)},startRowManipulation:function(){"function"===typeof a.startRowFX1&&a.startRowFX1(a);a.resetObjects();a.myTable.addClass(a.loadingClass);
a.myTable.find(a.moreRowEntriesSelector).hide();a.myTable.hide();a.myRows.each(function(b,d){jQuery(d).addClass(a.hideClass).removeClass(a.showClass)});"function"===typeof a.startRowFX2&&a.startRowFX2(a)},endRowManipulation:function(){"function"===typeof a.endRowFX1&&a.endRowFX1(a);a.resetObjects();var b=a.showFromRow,d=0,e=0,c=0,f=0===a.myTableBody.find("tr."+a.notMatchClass).length?!0:!1,h=!1;a.myRows.each(function(k,g){g=jQuery(g);d++;h=!1;if(f||g.hasClass(a.matchClass))h=!0,e++;h&&e>b&&c<a.visibleRowCount&&
(c++,g.removeClass(a.hideClass).addClass(a.showClass))});0<e?jQuery("."+a.noMatchMessageClass).hide():jQuery("."+a.noMatchMessageClass).show();var g=b+c,l=Math.ceil(e/a.visibleRowCount),v=Math.floor(a.showFromRow/a.visibleRowCount),t="";if(1<l){for(var p=0,q=0,r=v-2,w=v+2,p=0;p<l;p++)v===p?(q=0,t+="<span>["+(p+1)+"]</span>"):(test1=p>r&&p<w,test2=p>=l-3,test3=3>p,test1||test2||test3?(q=0,t+='<a href="#" data-page="'+p+'">'+(p+1)+"</a> "):3>q&&(q++,t+=" . ")),t+=" ";a.myTableHolder.find(a.moreRowEntriesSelector).show()}else a.myTableHolder.find(a.moreRowEntriesSelector).not(".alwaysShow").hide();
b++;e===d&&a.myTableHolder.find(a.matchRowCountSelector).text(e);a.myTableHolder.find(a.minRowSelector).text(b);a.myTableHolder.find(a.maxRowSelector).text(g);a.myTableHolder.find(a.totalRowCountSelector).text(d);a.myTableHolder.find(a.visibleRowCountSelector).text(c);a.myTableHolder.find(a.paginationSelector).html(t);a.myTable.show();a.myTable.removeClass(a.loadingClass);a.myTableHolder.hasClass(a.filterIsOpenClass)||window.setTimeout(function(){jQuery("html, body").animate({scrollTop:a.myTableHolder.position().top},
200)},a.millisecondsBetweenActions);a.useBackAndForwardButtons&&history.pushState(null,null,a.currentURL());a.resetObjects();"function"===typeof a.endRowFX2&&a.endRowFX2(a);a.fixTableHeader()},currentURL:function(){for(var b={},d=0;d<a.filterAndSortVariables.length;d++){var e=a.filterAndSortVariables[d];b[e]=a[e]}b="undefined"!==typeof JSURL?JSURL.stringify(b):"tfs="+encodeURI(JSON.stringify(b));return a.baseURL+"#"+b},makeRetrieveButtons:function(b,d,e){var c=[],f=a.serverConnectionURL;switch(e){case "favourites":var h=
a.favouritesParentPageID,g="favouritesStore";break;case "filters":h=a.filtersParentPageID,g=a.filterAndSortVariables.join(",")}b&&c.push('<li class="save '+e+" "+a.saveAndLoadClass+'"><a href="#" data-url="'+f+'start/" data-parent-page-id="'+h+'" data-variables="'+g+'">Save</a></li>');d&&c.push('<li class="load '+e+" "+a.saveAndLoadClass+'"><a href="#" data-url="'+f+'index/" data-parent-page-id="'+h+'" data-variables="'+g+'">Find</a></li>');if(0<c.length)return c.join("")},workOutCurrentFilter:function(){var b=
"",d,c="";a.currentFilter={};a.myFilterFormHolder.find(" ."+a.filterGroupClass).each(function(e,f){d=jQuery(f);c=d.attr("data-to-filter");var k=d.attr("field-type"),h=[];d.find("input").each(function(b,d){d=jQuery(d);var e=d.val(),f=e.toLowerCase().trim();switch(k){case "keyword":if(1<f.length)for("undefined"===typeof a.currentFilter[c]&&(a.debug&&console.log("adding "+c),a.currentFilter[c]=[]),e=f.split(","),f=e.length,b=0;b<f;b++)innerValueToMatch=innerInputVal=e[b].trim(),1<innerValueToMatch.length&&
(a.currentFilter[c].push({valueToMatch:innerValueToMatch,inputVal:innerInputVal}),h.push(innerValueToMatch),a.debug&&console.log("... adding '"+innerValueToMatch+"' to '"+c+"'"));break;case "tag":case "checkbox":d.is(":checked")&&("undefined"===typeof a.currentFilter[c]&&(a.debug&&console.log("adding "+c),a.currentFilter[c]=[]),h.push(f),a.currentFilter[c].push({valueToMatch:f,inputVal:e}),a.debug&&console.log("... adding '"+c+"' to '"+f+"'"));break;case "favourites":d.is(":checked")&&("undefined"===
typeof a.currentFilter[c]&&(a.debug&&console.log("adding "+c),a.currentFilter[c]=[]),a.currentFilter[c].push({valueToMatch:f,inputVal:e}),h.push(f),a.debug&&console.log("... adding '"+c+"' to '"+f+"'"));break;case "number":e=parseFloat(d.val());jQuery.isNumeric(e)&&0!==e&&("undefined"===typeof a.currentFilter[c]&&(a.debug&&console.log("adding "+c),a.currentFilter[c]=[]),h.push(d.attr("data-label")+e+" "),"undefined"===typeof a.currentFilter[c][0]&&(a.currentFilter[c][0]={}),a.currentFilter[c][0][d.attr("data-dir")]=
e);break;case "date":e=d.val().trim(),"0"!==e&&""!==e&&("undefined"===typeof a.currentFilter[c]&&(a.debug&&console.log("adding "+c),a.currentFilter[c]={}),h.push(d.attr("data-label")+e),a.currentFilter[c][0][d.attr("data-dir")]=e)}});if("undefined"!==typeof a.currentFilter[c]){var g=d.find("label."+a.groupLabelClass).text();b+='<li class="category"><strong>'+g+":</strong> <span>"+h.join("</span><span>")+"</span></li>"}});var k=0<Object.keys(a.currentFilter).length?!0:!1,f=[];!0===k?f.push('<li class="clear"><a href="#">\u2716</a></li>'):
b='<li class="noFilterSelected">'+a.noFilterSelectedText+"</li>";a.hasFilterSaving&&f.push(a.makeRetrieveButtons(k,!0,"filters"));0<f.length&&(b=f.join("")+b);0<b.length&&(b="<ul>"+b+"</ul>");k=a.myTableHolder.find("."+a.currentSearchFilterClass);f=k.attr("data-title");"undefined"===typeof f&&(f=a.currentFilterText);f.length&&(f="<h3>"+f+"</h3>");b=f+b;k.html(b)},retrieveLocalCookie:function(){"undefined"!==typeof Cookies&&(a.favouritesStore=Cookies.getJSON("favouritesStore"),"undefined"===typeof a.favouritesStore?
a.favouritesStore=[]:a.serverDataToApply.favouritesStore=!0)},retrieveDataFromURL:function(){if("undefined"!==typeof JSURL&&"undefined"!==typeof location.hash&&location.hash&&0<location.hash.length){var b=window.location.hash.substr(1);data=JSURL.tryParse(b,{});for(var c in data)data.hasOwnProperty(c)&&(a[c]=data[c],a.serverDataToApply[c]=!0);a.myTable.removeClass(a.loadingClass);a.processRetrievedData()}},retrieveDataFromServer:function(){var b={};"undefined"!==typeof location.search&&location.search&&
0<location.search.length&&(location.search.substr(1).split("&").forEach(function(a){var c=a.split("=");a=c[0];c=c[1]&&decodeURIComponent(c[1]);(b[a]=b[a]||[]).push(c)}),"undefined"!==typeof b.load&&(a.myTable.addClass(a.loadingClass),jQuery.getJSON(a.serverConnectionURL+"load/"+b.load+"/",function(b){b=b.Data;b=JSON.parse(b);for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c],a.serverDataToApply[c]=!0);a.myTable.removeClass(a.loadingClass);a.processRetrievedData()}).fail(function(){a.myTable.removeClass(a.loadingClass)})))},
processRetrievedData:function(){if("undefined"!==typeof a.serverDataToApply.favouritesStore&&!0===a.serverDataToApply.favouritesStore){a.myTableBody.find("tr."+a.favouriteClass).removeClass(a.favouriteClass);for(var b in a.favouritesStore)a.favouritesStore.hasOwnProperty(b)&&a.myTableBody.find("#"+a.favouritesStore[b]).addClass(a.favouriteClass);delete a.serverDataToApply.favouritesStore}},replaceAll:function(a,c,e){a.split(c).join(e);return a},objectSize:function(a){var b=0,c;if("undefined"===typeof a)return 0;
for(c in a)a.hasOwnProperty(c)&&b++;return b},objectSort:function(a){var b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push([c,a[c]]);b.sort(function(a,b){a=a[1];b=b[1];return a<b?-1:a>b?1:0});a={};for(c=c=0;c<b.length;c++)"string"===typeof b[c][1]&&(a[b[c][0]]=b[c][1]);return a},makeID:function(){for(var a="",c=0;9>c;c++)a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".charAt(Math.floor(52*Math.random()));return a},sortMultiDimensionalArray:function(a,c){var b=a[0];"string"===typeof b&&(b=b.toLowerCase());
var d=c[0];"string"===typeof d&&(d=d.toLowerCase());return b===d?0:b<d?-1:1}},a=jQuery.extend(a,c);this.each(function(b,c){a.init(g);g++});return{getVar:function(b){if(a.hasOwnProperty(b))return a[b]},setVar:function(b,c){a[b]=c;return this},gotoPage:function(b){a.gotoPage(b);return this}}}})(jQuery);
String.prototype.raw2attr=function(){return(""+this).replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r\n/g,"&#13;").replace(/[\r\n]/g,"&#13;")};
String.prototype.attr2raw=function(){var c;c=(""+this).replace(/\r\n/g,"\n").replace(/[\r\n]/,"\n").replace(/&#13;&#10;/g,"\n").replace(/&#1[03];/g,"\n").replace(/&#9;/g,"\t").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&apos;/g,"'");var l=/&[^;]*;?/.match(c);if(0<l.length&&"&amp;"!==l[0])throw"unsafe entity found in the attribute literal content";return c=c.replace(/&amp;/g,"&")};
jQuery.fn.isOnScreen=function(){var c,l;c=jQuery(window).scrollTop();l=c+jQuery(window).height();var g,h;g=this.offset().top;h=g+this.outerHeight();return g<=l&&h>=c};(function(c){var l=c.fn.on,g;c.fn.on=function(){var c=Array.apply(null,arguments),a=c[c.length-1];if(isNaN(a)||1===a&&c.pop())return l.apply(this,c);var b=c.pop(),d=c.pop();c.push(function(){var a=this,c=arguments;clearTimeout(g);g=setTimeout(function(){d.apply(a,c)},b)});return l.apply(this,c)}})(jQuery);
