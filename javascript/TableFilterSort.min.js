jQuery(document).ready(function(){if(typeof TableFilterSortTableList!=="undefined"){var a=0;for(a=0;a<TableFilterSortTableList.length;a++){TableFilterSortTableList[a]=jQuery(TableFilterSortTableList[a]).tableFilterSort()}}});(function(a){a.fn.tableFilterSort=function(d){var e=0;var b=this;var c={debug:false,baseURL:"",favouritesURL:"/tfs/favourites/",filtersURL:"/tfs/filters/",filtersParentPageID:"",favouritesParentPageID:"",useBackAndForwardButtons:false,holderNumber:0,myTableHolder:b,myFilterFormHolder:null,myTable:null,myTableHead:null,myTableBody:null,myRows:null,dataDictionary:[],currentFilter:{},currentSorter:{},showFromRow:0,visibleRowCount:50,totalRowCount:0,maximumNumberOfFilterOptions:3,intervalForFilterCheck:1000,hasFixedTableHeader:true,hasKeywords:true,hasFavourites:false,hasFilterSaving:false,millisecondsBetweenActions:10,validDataTypes:["number","string","date"],maxNumberOfValuesToCheck:500,favouritesStore:[],startRowFX1:null,startRowFX2:null,endRowFX1:null,endRowFX2:null,filterTitle:"Filter Table",noFilterSelectedText:"No filter selected",closeAndApplyFilterText:"Close and Apply Filter",currentFilterText:"Current Filter",greaterThanLabel:"&gt; ",lowerThanLabel:"&lt; ",keywordsCategoryTitle:"Keywords",favouritesCategoryTitle:"Favourites",filtersTitle:"Filter",tableSelector:"table.tableFilterSortTable",rowSelector:"tr.tfsRow",filterItemSelector:"span[data-filter]",showMoreDetailsSelector:".more",moreDetailsSelector:".hidden",filterFormHolderSelector:".tableFilterSortFilterFormHolder",sortLinkSelector:"a.sortable",favouriteLinkSelector:"a.addFav",moreRowEntriesSelector:".tableFilterSortMoreEntries",matchRowCountSelector:".match-row-number",minRowSelector:".min-row-number",maxRowSelector:".max-row-number",totalRowCountSelector:".total-row-number",visibleRowCountSelector:".total-showing-row-number",paginationSelector:".pagination",saveAndLoadSelector:".saveAndLoad",loadingClass:"loading",showClass:"show",hideClass:"hide",matchClass:"match",notMatchClass:"no-match",openedClass:"opened",filterIsOpenClass:"filterIsOpen",sectionFilterClassAppendix:"Filter",commonContentHolderClass:"tableFilterSortCommonContentHolder",currentSearchFilterClass:"tableFilterSortCurrentSearchHolder",openAndCloseFilterFormClass:"tableFilterSortOpenFilterForm",filterOptionsHolderClass:"tableFilterSortFilterFormOptions",filterGroupClass:"filterColumn",groupLabelClass:"groupLabel",applyFilterClass:"applyFilter",filterInUseClass:"tableFilterSortFilterInUse",filterNotInUseClass:"tableFilterSortFilterNotInUse",noMatchMessageClass:"no-matches-message",sortAscClass:"sort-asc",sortDescClass:"sort-desc",directLinkClass:"dl",favouriteClass:"fav",init:function(g){var f=c;f.holderNumber=g;f.myTableHolder=b;f.myFilterFormHolder=f.myTableHolder.find(f.filterFormHolderSelector).first();f.myTable=f.myTableHolder.find(f.tableSelector).first();f.myTableHead=f.myTableHolder.find("table thead");f.myTableBody=f.myTable.find(" > tbody");f.favouritesParentPageID=f.myFilterFormHolder.attr("data-favourites-page-id");if(typeof f.favouritesParentPageID==="string"&&f.favouritesParentPageID.length>0){f.hasFavourites=true}f.filtersParentPageID=f.myFilterFormHolder.attr("data-filter-page-id");if(typeof f.filtersParentPageID==="string"&&f.filtersParentPageID.length>0){f.hasFilterSaving=true}f.baseURL=location.protocol+"//"+location.host+location.pathname;f.resetObjects();if(f.myRows.length>1){f.myTableHolder.addClass(f.loadingClass);window.setTimeout(function(){if(f.debug){console.profileEnd();console.profile("filterItemCollector")}f.filterItemCollector();if(f.debug){console.profileEnd();console.profile("tableHideColsWhichAreAllTheSame")}f.tableHideColsWhichAreAllTheSame();if(f.debug){console.profileEnd();console.profile("dataDictionaryCollector")}f.dataDictionaryCollector();if(f.debug){console.profileEnd();console.profile("setupFilterFormListeners")}f.setupFilterFormListeners();if(f.debug){console.profileEnd();console.profile("setupSortListeners")}f.setupSortListeners();if(f.debug){console.profileEnd();console.profile("paginationListeners")}f.paginationListeners();if(f.debug){console.profile("toggleSlideSetup")}f.toggleSlideSetup();if(f.debug){console.profile("addURLChangeListener")}f.addURLChangeListener();if(f.debug){console.profileEnd();console.profile("retrieveServerDataListener")}f.retrieveServerDataListener();if(f.debug){console.profileEnd();console.profile("favouriteLinkListener")}f.favouriteLinkListener();if(f.debug){console.profileEnd();console.profile("directFilterLinkListener")}f.directFilterLinkListener();if(f.debug){console.profileEnd();console.profile("createFilterForm")}f.createFilterForm();if(f.debug){console.profileEnd()}f.myTableHolder.removeClass(f.loadingClass);if(f.debug){console.profile("runCurrentSort")}f.runCurrentSort();if(f.debug){console.profileEnd();console.profile("retrieveCookieData")}f.retrieveCookieData();if(f.debug){console.profileEnd();console.profile("showAndHideFilterForm")}f.showAndHideFilterForm();if(f.debug){console.profileEnd();console.profile("fixTableHeader")}f.fixTableHeader();if(f.debug){console.profileEnd()}},f.millisecondsBetweenActions)}},resetObjects:function(){var f=c;f.myRows=f.myTable.find(f.rowSelector)},filterItemCollector:function(){var f=c;var h="";var g="";f.myRows.each(function(j,k){jQuery(k).find(f.filterItemSelector).each(function(i,l){l=jQuery(l);h=l.text();g=l.attr("data-filter");if(h.trim().length>0){if(f.debug){console.debug("adding "+h+" to "+g)}if(typeof f.dataDictionary[g]==="undefined"){f.dataDictionary[g]={}}if(typeof f.dataDictionary[g]["Options"]==="undefined"){f.dataDictionary[g]["Options"]=[]}if(f.dataDictionary[g]["Options"].indexOf(h)===-1){f.dataDictionary[g]["Options"].push(h)}}})})},tableHideColsWhichAreAllTheSame:function(){var g=c;var h=g.myTableHolder.find("."+g.commonContentHolderClass).attr("data-title");if(typeof h!=="undefined"){h="<h3>"+h+"</h3>"}else{h=""}var i='<div class="'+g.commonContentHolderClass+'-inner">'+h+"<ul>";var f=false;Object.keys(g.dataDictionary).forEach(function(k,l){if(g.dataDictionary[k]["Options"].length===1){delete g.dataDictionary[k];if(g.debug){console.debug("tableHideColsWhichAreAllTheSame: checking category: "+k)}f=true;var j=false;jQuery('span[data-filter="'+k+'"]').each(function(n,o){o=jQuery(o);if(!j){if(o.html()!==""){i+="<li><strong>"+k+":</strong> <span>"+o.html()+"</span></li>";j=true}}var p=o.parent();o.remove();if(p.is("li")){p.hide()}else{if(p.is("td")){if(p.children().length===0){if(n===0){var m=p.parent("tr").children("td").index(p);g.myTable.find("th").eq(m).remove()}p.remove()}}}})}});i+="</ul></div>";if(f){g.myTableHolder.find("."+g.commonContentHolderClass).html(i)}else{g.myTableHolder.find("."+g.commonContentHolderClass).remove()}},dataDictionaryCollector:function(){var f=c;Object.keys(f.dataDictionary).forEach(function(k,l){if(typeof f.dataDictionary[k]["Options"]==="undefined"){f.dataDictionary[k]["Options"]=[]}var o=f.myTable.find(f.sortLinkSelector+'[data-sort-field="'+k+'"]').first();if(typeof f.dataDictionary[k]["CanFilter"]==="undefined"){if(o&&o.attr("data-sort-only")=="true"){f.dataDictionary[k]["CanFilter"]=false}else{f.dataDictionary[k]["CanFilter"]=f.dataDictionary[k]["Options"].length>1}}if(typeof f.dataDictionary[k]["CanSort"]==="undefined"){f.dataDictionary[k]["CanSort"]=o.length>0}if(typeof f.dataDictionary[k]["DataType"]==="undefined"){if(f.dataDictionary[k]["CanSort"]){var m=o.attr("data-sort-type");f.dataDictionary[k]["DataType"]=m}}if(typeof f.dataDictionary[k]["DataType"]==="undefined"){var j="number";var n=false;var h=0;var g=f.dataDictionary[k]["Options"].length<f.maxNumberOfValuesToCheck?f.dataDictionary[k]["Options"].length:500;for(h=0;h<g;h++){n=jQuery.isNumeric(f.dataDictionary[k]["Options"][h]);if(n===false){j="string";break}}f.dataDictionary[k]["DataType"]=j}if(jQuery.inArray(f.dataDictionary[k]["DataType"],f.validDataTypes)===false){console.debug("ERROR: invalid DataType for"+k+": "+f.dataDictionary[k]["DataType"])}switch(f.dataDictionary[k]["DataType"]){case"number":f.dataDictionary[k]["Options"].sort(function(p,i){p=parseFloat(p.replace(/[^0-9.]/g,""));i=parseFloat(i.replace(/[^0-9.]/g,""));return p-i});break;case"string":default:f.dataDictionary[k]["Options"].sort()}})},setupFilterFormListeners:function(){var f=c;f.myTableHolder.on("click","."+f.openAndCloseFilterFormClass,function(g){g.preventDefault();f.myFilterFormHolder.find("."+f.filterOptionsHolderClass).toggleClass(f.openedClass).slideToggle("fast");f.myTableHolder.toggleClass(f.filterIsOpenClass);if(f.myTableHolder.hasClass(f.filterIsOpenClass)){}else{f.applyFilter()}return false})},setupSortListeners:function(){var f=c;f.myTableHolder.on("click",f.sortLinkSelector,function(g){g.preventDefault();var h=jQuery(this);f.showFromRow=0;f.startRowManipulation();f.myTableHead.find(f.sortLinkSelector).removeClass(f.sortAscClass).removeClass(f.sortDescClass);window.setTimeout(function(){f.currentSorter.category=h.attr("data-sort-field");f.currentSorter.direction=h.attr("data-sort-direction");f.currentSorter.sortType=h.attr("data-sort-type");if(typeof f.currentSorter.sortType==="undefined"){f.currentSorter.sortType=f.dataDictionary[f.currentSorter.category]["DataType"]}var i=[];f.myRows.each(function(l,m){var o=jQuery(m);var n=o.find('[data-filter="'+f.currentSorter.category+'"]').text();if(f.currentSorter.sortType==="number"){n=n.replace(/[^\d.-]/g,"");n=parseFloat(n)}else{}var k=new Array(n,l);i.push(k)});f.myTableBody.empty();i.sort(f.sortMultiDimensionalArray);var j=f.myTableHead.find(f.sortLinkSelector+'[data-sort-field="'+f.currentSorter.category+'"]');if(f.currentSorter.direction==="desc"){i.reverse();j.attr("data-sort-direction","asc").addClass(f.sortDescClass)}else{j.attr("data-sort-direction","desc").addClass(f.sortAscClass)}i.forEach(function(k){f.myTableBody.append(f.myRows[k[1]])});f.endRowManipulation()},f.millisecondsBetweenActions)})},paginationListeners:function(){var f=c;f.myTableHolder.on("click",f.paginationSelector+" a",function(h){h.preventDefault();var g=jQuery(this).attr("data-page");f.gotoPage(g);return false})},toggleSlideSetup:function(){var f=c;f.myTableHolder.on("click",f.showMoreDetailsSelector,function(g){g.preventDefault();var i=jQuery(this);var h=i.closest("tr");h.toggleClass(f.openedClass).find(f.moreDetailsSelector).each(function(k,j){j=jQuery(j);j.slideToggle();j.toggleClass(f.openedClass)});i.toggleClass(f.openedClass)})},addURLChangeListener:function(){var f=c;if(f.useBackAndForwardButtons){window.addEventListener("popstate",function(g){f.findAndApplyGetVariables()})}},directFilterLinkListener:function(){var f=c;f.myTableBody.on("click","span[data-filter]."+f.directLinkClass,function(j){j.preventDefault();var m=jQuery(this);var i=m.attr("data-filter");var l=m.text().trim();var k=f.myFilterFormHolder.find("."+f.filterGroupClass+'[data-to-filter="'+i+'"]');var h=k.attr("field-type");var g=k.find('input[value="'+l+'"].checkbox').first();if(g&&g.length>0){if(g.is(":checkbox")){if(g.prop("checked")===true){g.prop("checked",false).trigger("change")}else{g.prop("checked",true).trigger("change")}}}else{if(h==="tag"){f.makeCheckboxSection(k.find("input.awesomplete").first(),l)}}f.applyFilter();return false})},favouriteLinkListener:function(){var f=c;if(f.myTableBody.find(f.favouriteLinkSelector).length>0){f.myTableHolder.on("click",f.favouriteLinkSelector,function(h){h.preventDefault();var j=jQuery(this).closest("tr");j.toggleClass(f.favouriteClass);var i=j.attr("id");if(i&&typeof i!=="undefined"&&i!==""){if(j.hasClass(f.favouriteClass)){f.favouritesStore.push(i)}else{var g=f.favouritesStore.indexOf(i);if(g>-1){f.favouritesStore.splice(g,1)}}Cookies.set("favouritesStore",f.favouritesStore,{path:f.baseURL,expires:180})}return false})}},retrieveServerDataListener:function(){var f=c;f.myTableHolder.on("click",f.saveAndLoadSelector+" a",function(i){i.preventDefault();var m=jQuery(this);var g=m.attr("href");var l=false;var k=false;var h=f.favouritesParentPageID;var j={};if(m.hasClass("save")){k=true}if(m.hasClass("filters")){l=true;var h=f.filtersParentPageID}if(k){if(l){j={f:f.currentFilter,s:f.currentSorter}}else{j={f:f.favouritesStore}}}h=h.split("/").join("--");dataAsString=JSON.stringify(j);fullURL=g+encodeURI(h)+"/?data="+encodeURI(dataAsString);jQuery.modal('<iframe src="'+fullURL+'" height="450" width="830" style="border:0">',{closeHTML:"",containerCss:{backgroundColor:"#fff",borderColor:"#fff",height:450,padding:0,width:830},overlayClose:true});m.modal();return false})},createFilterForm:function(){var q=c;if(q.myFilterFormHolder.length>0){var g=q.myFilterFormHolder.attr("data-title");if(typeof g==="undefined"){g=q.filterTitle}if(q.myTableHolder.find("."+q.currentSearchFilterClass).length===0){var n='<div class="'+q.currentSearchFilterClass+'"></div>'}var h=1;var p=[];var k="<form>"+n+'<a href="#" class="'+q.openAndCloseFilterFormClass+' button closed">'+g+'</a><div style="display: none;" class="'+q.filterOptionsHolderClass+'">';if(q.hasKeywords){k+=q.makeSectionHeaderForForm("keyword",q.keywordsCategoryTitle);k+=q.makeFieldForForm("keyword",q.keywordsCategoryTitle,h,0);k+=q.makeSectionFooterForForm()}Object.keys(q.dataDictionary).forEach(function(u,v){if(q.dataDictionary[u]["CanFilter"]){h++;var s="";var i=[];var t=0;var x=q.dataDictionary[u]["Options"].length;if(x>1&&x<=q.maximumNumberOfFilterOptions){k+=q.makeSectionHeaderForForm("checkbox",u);t=0;for(t=0;t<x;t++){var w=q.dataDictionary[u]["Options"][t];k+=q.makeFieldForForm("checkbox",u,h,w)}k+=q.makeSectionFooterForForm()}else{if(x>q.maximumNumberOfFilterOptions){var r=q.dataDictionary[u]["DataType"];if(q.dataDictionary[u]["DataType"]==="string"){p.push(u);r="tag"}k+=q.makeSectionHeaderForForm(r,u);k+=q.makeFieldForForm(r,u,h,0);k+=q.makeSectionFooterForForm()}}}});if(q.hasFavourites){k+=q.makeSectionHeaderForForm("favourites",q.favouritesCategoryTitle);k+=q.makeFieldForForm("favourites",q.favouritesCategoryTitle,h,0);k+=q.makeSectionFooterForForm();h++}var m=q.myFilterFormHolder.attr("data-title-close-and-apply");if(typeof m==="undefined"){m=q.closeAndApplyFilterText}k+='<div class="'+q.applyFilterClass+'"><a href="#" class="'+q.openAndCloseFilterFormClass+' button closed">'+m+"</a></div></div></form>";q.myFilterFormHolder.html(k);var j=0;var o;for(j=0;j<p.length;j++){category=p[j];var l=q.myFilterFormHolder.find('input[name="'+category+'"].awesomplete').first();var f=jQuery(l).attr("id");var o=document.getElementById(f);new Awesomplete(o,{list:q.dataDictionary[category]["Options"],autoFirst:true,replace:function(r){q.makeCheckboxSection(this.input,r.value);this.input.value="";var i=this._list.indexOf(r.value);if(i>-1){this._list.splice(i,1)}}})}}},makeSectionHeaderForForm:function(h,j){var g=c;var f=h+g.sectionFilterClassAppendix;var i=j.replace(/\W/g,"");var g=c;return'<div class="'+g.filterGroupClass+" "+f+'" field-type="'+h+'" data-to-filter="'+j.raw2attr()+'"><label class="'+g.groupLabelClass+'">'+g.replaceAll(j,"-"," ")+"</label><ul>"},makeFieldForForm:function(k,f,g,l){var t=c;var i=f.replace(/\W/g,"");var h=l.toString();var j=("TFS_"+i+"_"+h).replace(/[^a-zA-Z0-9]+/g,"_");if(t.myFilterFormHolder.find("input#"+j).length===0){var m='<li class="'+k+'Field">';var p="</li>";switch(k){case"favourites":return m+'<input class="favourites" type="checkbox" name="'+f.raw2attr()+'" id="'+j+'" tabindex="'+g+'" /><label for="'+j+'">♥ ♥ ♥</label>'+p;break;case"keyword":case"tag":var r="";if(typeof t.currentFilter[f]!=="undefined"){if(typeof t.currentFilter[f][0]!=="undefined"){r=t.currentFilter[f][0];r=r.raw2attr()}}if(k==="keyword"){extraClass="keyword"}else{if(k==="tag"){extraClass="awesomplete"}}return m+'<input class="text '+extraClass+'" type="text" name="'+f.raw2attr()+'" id="'+j+'" tabindex="'+g+'" />'+p;case"checkbox":var o="";if(typeof t.currentFilter[f]!=="undefined"){var n=jQuery.inArray(l,t.currentFilter[f]);if(n>-1){o='checked="checked"'}}return m+'<input class="checkbox" type="checkbox" name="'+j+'" id="'+j+'" value="'+l.raw2attr()+'" '+o+' " tabindex="'+g+'" /><label for="'+j+'">'+l+"</label>"+p;case"number":case"date":var r=["",""];if(typeof t.currentFilter[f]!=="undefined"){r=t.currentFilter[f]}var q=m+'<span class="gt"> <label for="'+j+'_gt">'+t.greaterThanLabel+'</label> <input data-dir="gt" data-label="'+t.greaterThanLabel.raw2attr()+'" class="number" step="any" type="number" name="'+i+'[]" id="'+j+'" tabindex="'+g+'" value="'+r[0].raw2attr()+'" /> </span><span class="lt"> <label for="'+j+'_lt">'+t.lowerThanLabel+'</label> <input data-dir="lt" data-label="'+t.lowerThanLabel.raw2attr()+'"  class="number" step="any" type="number" name="'+i+'[]" id="'+j+'_lt" tabindex="'+g+'" value="'+r[1].raw2attr()+'" /> </span>'+p;if(k==="date"){q=t.replaceAll(q,"number","datetime-local");q=t.replaceAll(q,"step","86400")}return q}}},makeSectionFooterForForm:function(){return"</ul></div>"},makeCheckboxSection:function(f,j){var h=c;f=jQuery(f);var i=f.attr("name");tabIndex=f.attr("tabindex");var g=h.makeFieldForForm("checkbox",i,tabIndex,j);if(g.length>5){g=g.replace("<input ",'<input checked="checked" ');f.closest("ul").append(g)}},runCurrentSort:function(){var g=c;var f="."+g.sortDescClass+", ."+g.sortAscClass;var h=g.myTableHolder.find(f).first();if(h&&h.length>0){}else{h=g.myTableHolder.find(g.sortLinkSelector+"[data-sort-default=true]").first()}if(h&&h.length>0){}else{h=g.myTableHolder.find(g.sortLinkSelector).first()}if(h&&h.length>0){h.click()}},applyFilter:function(){var f=c;f.showFromRow=0;f.workOutCurrentFilter();f.startRowManipulation();window.setTimeout(function(){if(f.debug){console.debug("==============");console.debug(f.currentFilter)}f.myRows.each(function(h,j){var l=jQuery(j);if(f.debug){console.log("===")}var k=true;var g=true;Object.keys(f.currentFilter).forEach(function(o,n){if(g){var m=false;var p=true;for(var q=0;q<f.currentFilter[o].length;q++){var v=f.currentFilter[o][q];if(p){if(o===f.favouritesCategoryTitle){var w=l.attr("id");if(typeof w!=="undefined"&&w.length>0){if(f.favouritesStore.indexOf(w)>-1){m=true}}}else{if(o===f.keywordsCategoryTitle){var x=v.valueToMatch;var y=l.text().toLowerCase();var t=x.split(" ");var s=true;for(var r=0;r<t.length;r++){var u=t[r].trim();if(y.indexOf(u)===-1){s=false;break}}if(s===true){m=true}}else{l.find('span[data-filter="'+o+'"]').each(function(E,D){D=jQuery(D);var C=D.text().toLowerCase().trim();switch(f.dataDictionary[o]["DataType"]){case"date":break;case"number":if(typeof v.valueToMatch!=="undefined"){var B=v.valueToMatch;if(C==B){m=true}}else{C=parseFloat(C.replace(/[^0-9.]/g,""));var i=v.lt;var A=true;if(jQuery.isNumeric(i)&&i!==0){if(i<C){A=false}}if(A){var z=v.gt;if(jQuery.isNumeric(z)&&z!==0){if(z>C){A=false}}}if(A){m=true}break}case"string":default:var B=v.valueToMatch;if(C===B){m=true}}if(m){if(f.debug){console.log("FILTER - MATCH: '"+B+"' in '"+o+"'")}return false}else{if(f.debug){console.log("FILTER - NO MATCH: '"+B+"' in '"+o+"'")}}})}}if(m){p=false}}}if(!m){k=false;g=false}}});if(k){l.addClass(f.matchClass).removeClass(f.notMatchClass)}else{l.addClass(f.notMatchClass).removeClass(f.matchClass)}});f.endRowManipulation();if(f.debug){console.debug(f.currentFilter);console.debug("==============")}},f.millisecondsBetweenActions)},gotoPage:function(g){var f=c;f.showFromRow=g*f.visibleRowCount;f.startRowManipulation();f.endRowManipulation()},showAndHideFilterForm:function(){var f=c;window.setInterval(function(){if(f.myTableHolder.isOnScreen()||f.myTableHolder.hasClass(f.filterIsOpenClass)){f.myTableHolder.addClass(f.filterInUseClass);f.myTableHolder.removeClass(f.filterNotInUseClass)}else{f.myTableHolder.addClass(f.filterNotInUseClass);f.myTableHolder.removeClass(f.filterInUseClass)}},f.intervalForFilterCheck)},fixTableHeader:function(){var f=this;var g=false;if(f.hasFixedTableHeader){jQuery(window).bind("load resize scroll",function(i){if(i.type==="resize"){g=false}var h=f.myTableBody.offset().top;var j=jQuery(this).scrollTop();if(j>h){f.myTableHolder.addClass("fixed-header");f.myTableHead.css("top",f.myFilterFormHolder.outerHeight())}else{if(j<=h){f.myTableHolder.removeClass("fixed-header");if(!g){g=true;f.myFilterFormHolder.width(f.myTableHolder.width());f.myTable.width(f.myTableHolder.width());f.myTable.find("thead tr:first th, thead tr:first td").each(function(l,k){var k=jQuery(k);k.width(k.width())})}}}})}},startRowManipulation:function(){var f=c;if(typeof f.startRowFX1==="function"){f.startRowFX1(f)}f.resetObjects();f.myTableHolder.addClass(f.loadingClass).find(f.moreRowEntriesSelector).hide();f.myTable.hide();f.myRows.each(function(g,h){jQuery(h).addClass(f.hideClass).removeClass(f.showClass)});if(typeof f.startRowFX2==="function"){f.startRowFX2(f)}},endRowManipulation:function(){var w=c;if(typeof w.endRowFX1==="function"){w.endRowFX1(w)}w.resetObjects();var p=w.showFromRow;var j=0;var t=0;var g=0;var u=w.myTableBody.find("tr."+w.notMatchClass).length===0?true:false;var m=false;w.myRows.each(function(x,y){y=jQuery(y);j++;m=false;if(u||y.hasClass(w.matchClass)){m=true;t++}if(m){if(t>p&&g<w.visibleRowCount){g++;y.removeClass(w.hideClass).addClass(w.showClass)}}});if(t>0){jQuery("."+w.noMatchMessageClass).hide()}else{jQuery("."+w.noMatchMessageClass).show()}var s=p+g;var h=Math.ceil(t/w.visibleRowCount);var n=Math.floor(w.showFromRow/w.visibleRowCount);var r="";if(h>1){var l=0;var f=0;var o=n-2;var k=n+2;for(l=0;l<h;l++){if(n===l){f=0;r+="<span>["+(l+1)+"]</span>"}else{test1=(l>o&&l<k);test2=(l>=(h-3));test3=(l<(0+3));if(test1||test2||test3){f=0;r+='<a href="#" data-page="'+l+'">'+(l+1)+"</a> "}else{if(f<3){f++;r+=" . "}}}r+=" "}w.myTableHolder.find(w.moreRowEntriesSelector).show()}else{w.myTableHolder.find(w.moreRowEntriesSelector).not(".alwaysShow").hide()}p++;w.myTableHolder.find(w.matchRowCountSelector).text(t);w.myTableHolder.find(w.minRowSelector).text(p);w.myTableHolder.find(w.maxRowSelector).text(s);w.myTableHolder.find(w.totalRowCountSelector).text(j);w.myTableHolder.find(w.visibleRowCountSelector).text(g);w.myTableHolder.find(w.paginationSelector).html(r);w.myTable.show();var q=[];if(w.hasFavourites){q.push(w.makeRetrieveButtons(w.favouritesStore.length>0,"favourites"))}if(w.hasFilterSaving){q.push(w.makeRetrieveButtons(w.currentFilter.length>0,"filters"))}if(q.length>0){var v="<ul>"+q.join("</li><li>")+"</ul>";w.myTableHolder.find(w.saveAndLoadSelector).html(v)}w.myTableHolder.removeClass(w.loadingClass);window.setTimeout(function(){jQuery("html, body").animate({scrollTop:w.myTableHolder.position().top},200)},100);if(w.useBackAndForwardButtons){history.pushState(null,null,w.currentURL())}w.resetObjects();if(typeof w.endRowFX2==="function"){w.endRowFX2(w)}},currentURL:function(){var g=c;var h={};h.f=g.currentFilter;h.s=g.currentSorter;var f="tfs="+encodeURI(JSON.stringify(h));return g.baseURL+"?"+f},makeRetrieveButtons:function(f,i){var h=c;var j=[];switch(i){case"favourites":var g=h.favouritesURL;var k=h.favouritesCategoryTitle;break;case"filters":var g=h.filtersURL;var k=h.filtersTitle;break}if(f){j.push('<a href="'+g+'save/" class="save '+i+'">Save '+k+"</a>")}j.push('<a href="'+g+'index/" class="load '+i+'">Load '+k+"</a>");return buttonHTML="<li>"+j.join(" | ")+"</li>"},workOutCurrentFilter:function(){var o=c;var h="";var n;var g="";var i="";var f="";var j="";var m=[];o.currentFilter={};o.myFilterFormHolder.find(" ."+o.filterGroupClass).each(function(r,t){n=jQuery(t);g=n.attr("data-to-filter");var p=n.attr("field-type");if(p==="keyword"){var q="keyword"}else{if(p==="favourites"){var q="favourites"}else{var q=o.dataDictionary[g]["DataType"]}}var u=[];n.find("input").each(function(A,x){x=jQuery(x);var z=x.val();var y=z.toLowerCase().trim();switch(p){case"keyword":if(y.length>1){if(typeof o.currentFilter[g]==="undefined"){if(o.debug){console.log("adding "+g)}o.currentFilter[g]=[]}if(i==="keyword"){o.currentFilter[g].push({valueToMatch:y,inputVal:z});u.push(y)}else{var B=y.split(",");var A=0;var v=B.length;var w="";for(A=0;A<v;A++){innerInputVal=B[A].trim();innerValueToMatch=innerInputVal;if(innerValueToMatch.length>1){o.currentFilter[g].push({valueToMatch:innerValueToMatch,inputVal:innerInputVal});u.push(innerValueToMatch);if(o.debug){console.log("... adding '"+innerValueToMatch+"' to '"+g+"'")}}}}}break;case"tag":case"checkbox":if(x.is(":checked")){if(typeof o.currentFilter[g]==="undefined"){if(o.debug){console.log("adding "+g)}o.currentFilter[g]=[]}u.push(y);o.currentFilter[g].push({valueToMatch:y,inputVal:z});if(o.debug){console.log("... adding '"+g+"' to '"+y+"'")}}break;case"favourites":if(x.is(":checked")){if(typeof o.currentFilter[g]==="undefined"){if(o.debug){console.log("adding "+g)}o.currentFilter[g]=[]}o.currentFilter[g].push({valueToMatch:y,inputVal:z});u.push(y);if(o.debug){console.log("... adding '"+g+"' to '"+y+"'")}}break;case"number":var C=parseFloat(x.val());if(jQuery.isNumeric(C)&&C!==0){if(typeof o.currentFilter[g]==="undefined"){if(o.debug){console.log("adding "+g)}o.currentFilter[g]=[]}u.push(x.attr("data-label")+C+" ");if(typeof o.currentFilter[g][0]==="undefined"){o.currentFilter[g][0]={}}o.currentFilter[g][0][x.attr("data-dir")]=C}break;case"date":var C=x.val().trim();if(C!=="0"&&C!==""){if(typeof o.currentFilter[g]==="undefined"){if(o.debug){console.log("adding "+g)}o.currentFilter[g]={}}u.push(x.attr("data-label")+C);o.currentFilter[g][0][x.attr("data-dir")]=C}break}});if(typeof o.currentFilter[g]!=="undefined"){var s=n.find("label."+o.groupLabelClass).text();h+="<li><strong>"+s+":</strong> <span>"+u.join("</span><span>")+"</span></li>"}});if(h.length===0){h=o.noFilterSelectedText}var l=o.myTableHolder.find("."+o.currentSearchFilterClass);var k=l.attr("data-title");if(typeof k==="undefined"){k=o.currentFilterText}h="<div><h3>"+k+"</h3><ul>"+h+"</ul></div>";l.html(h);if(o.myTableHolder.hasClass(o.filterIsOpenClass)){l.hide()}else{l.show()}},retrieveCookieData:function(){var f=c;f.favouritesStore=Cookies.getJSON("favouritesStore");if(typeof f.favouritesStore==="undefined"){f.favouritesStore=[]}for(var g in f.favouritesStore){if(f.favouritesStore.hasOwnProperty(g)){var h=f.favouritesStore[g];f.myTableBody.find("#"+h).toggleClass(f.favouriteClass)}}},findAndApplyGetVariables:function(){var h=c;var g={};location.search.substr(1).split("&").forEach(function(m){var l=m.split("="),j=l[0],i=l[1]&&decodeURIComponent(l[1]);(g[j]=g[j]||[]).push(i)});if(typeof g.tfs!=="undefined"){var f=JSON.parse(g.tfs);h.currentFilter=f.f;h.currentSorter=f.s}},replaceAll:function(f,g,h){f.split(g).join(h);return f},objectSize:function(f){var h=0;var g;if(typeof f==="undefined"){return 0}for(g in f){if(f.hasOwnProperty(g)){h++}}return h},objectSort:function(h){var g=[];for(var f in h){if(h.hasOwnProperty(f)){g.push([f,h[f]])}}g.sort(function(l,i){l=l[1];i=i[1];return l<i?-1:(l>i?1:0)});var k={};var j=0;for(j=0;j<g.length;j++){if((typeof g[j][1])==="string"){k[g[j][0]]=g[j][1]}}return k},makeID:function(){var h="";var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";for(var g=0;g<9;g++){h+=f.charAt(Math.floor(Math.random()*f.length))}return h},sortMultiDimensionalArray:function(h,g){var f=h[0];if(typeof f==="string"){f=f.toLowerCase()}var i=g[0];if(typeof i==="string"){i=i.toLowerCase()}if(f===i){return 0}else{return(f<i)?-1:1}}};c=jQuery.extend(c,d);this.each(function(f,g){c.init(e);e++});return{getVar:function(f){if(c.hasOwnProperty(f)){return c[f]}},setVar:function(g,f){c[g]=f;return this},gotoPage:function(f){c.gotoPage(f);return this}}}}(jQuery));String.prototype.raw2attr=function(){return(""+this).replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r\n/g,"&#13;").replace(/[\r\n]/g,"&#13;")};String.prototype.attr2raw=function(){var a=(""+this);a=a.replace(/\r\n/g,"\n").replace(/[\r\n]/,"\n").replace(/&#13;&#10;/g,"\n").replace(/&#1[03];/g,"\n").replace(/&#9;/g,"\t").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&apos;/g,"'");var b=/&[^;]*;?/.match(a);if(b.length>0&&b[0]!=="&amp;"){throw"unsafe entity found in the attribute literal content"}a=a.replace(/&amp;/g,"&");return a};jQuery.fn.isOnScreen=function(){var a={};a.top=jQuery(window).scrollTop();a.bottom=a.top+jQuery(window).height();var b={};b.top=this.offset().top;b.bottom=b.top+this.outerHeight();return((b.top<=a.bottom)&&(b.bottom>=a.top))};